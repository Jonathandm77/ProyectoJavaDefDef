<!DOCTYPE html>
<html lang="en">

<head th:insert="librerias::librerias">

</head>

<body class="container-fluid oscuro blue-letter">

	<div th:insert="top"></div>
	<div class="container">


		<h1>Registro de Profesores</h1>

		<table class="table blue-letter">
			<thead class="bg-info oscuro-panel">
				<tr>
					<td>ID</td>
					<td>Dni</td>
					<td>Nombre</td>
					<td>Apellidos</td>
					<td sec:authorize="hasAuthority('ROLE_ADMIN')" colspan="2">Acciones</td>


				</tr>
			</thead>
			<tbody class="blue-letter-light">
				<tr th:if="${listaProfesores.Empty}">
					<td colspan="2">No hay profesores </td>
				<tr th:each="profe:${listaProfesores}">
					<td>
						<a th:href="@{/profesores/{id}(id=${profe.id})}" class="btn btn-primary btn-sm">
							<span th:text="${profe.id}"></span>
						</a>
					</td>
					<td>
						<span th:text="${profe.dni}"> </span>
					</td>
					<td>
						<span th:text="${profe.nombre}"> </span>
					</td>
					<td>
						<span th:text="${profe.apellidos}"></span>
					</td>
					<td sec:authorize="hasAuthority('ROLE_ADMIN')">
						<a th:attr="data-target='#modal-edit'+${profe.id}" data-toggle="modal" data-target="#modal-edit"
							class="btn btn-primary btn-sm text-white pointer">
							Modificar
						</a>
					</td>
					<td sec:authorize="hasAuthority('ROLE_ADMIN')">
						<a th:attr="data-target='#modal-delete'+${profe.id}" data-toggle="modal"
							data-target="#modal-delete" class="btn btn-primary btn-sm text-white pointer">
							Eliminar
						</a>
					</td>


			</tbody>
		</table>

		<div>
			<div class="row">
				<div class="col-md-auto mb-3">
					<button sec:authorize="hasAuthority('ROLE_ADMIN')" class="btn btn-primary" type="button"
						data-toggle="modal" data-target="#crearProfe"> Añadir Profesor </button>

				</div>

				<div th:object="${profe}" class="col-md-auto mb-3">
					<button th:attr="data-target='#modal-search'" class="btn btn-primary" type="button"
						data-toggle="modal" data-target="#buscarProfePorNombre">Buscar profesor por nombre</button>
				</div>

				<div th:object="${profe}" class="col-md-auto mb-3">
					<button th:attr="data-target='#modal-search-DNI'" class="btn btn-primary" type="button"
						data-toggle="modal" data-target="#buscarProfePorDni">Buscar profesor por DNI</button>
				</div>
			</div>
			<div id="error-message" class="alert alert-danger w-50 m-auto text-center p-5 mt-3" th:if="${error}">
				[[${error}]]
			</div>
		</div>

		<!-- buscar por dni modal-->
		<div th:each="profe:${listaProfesores}">
			<div class="modal fade" th:id="modal-search-DNI">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header oscuro-header">
							<h4 class="modal-title" id="exampleModalLabel">Buscar Profesor</h4>
							<button class="close btn btn-danger" type="button" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">x</span>
							</button>
						</div>
						<div class="modal-body oscuro">
							<p class="error-text">Introduce el DNI para buscar</p>


							<!--formulario dni-->
							<form action="#" th:action="@{/profesores/searchDni}" th:object="${profeaBuscar}"
								method="post">
								<div class"form-row">
									<div class="form-group mt-1">
										<label for="texto">DNI</label>
										<input type="text" placeholder="DNI" th:field="*{dni}" class="form-control campo-form"
											id="exampleInputDni" />
									</div>
								</div>
						</div>
						<div class="modal-footer oscuro-header">
							<button class="btn btn-secondary btn-sm" data-dismiss="modal"
								aria-hidden="true">Cancelar</button>
							<input id="sent" type="submit" th:value="Buscar" class="btn btn-primary float-right" />
						</div>
						</form>
					</div>
				</div>
			</div>

		</div>
		<!-- fin modal buscar por dni-->

		<!-- buscar por nombre modal-->
		<div th:each="profe:${listaProfesores}">
			<div class="modal fade" th:id="modal-search">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header oscuro-header">
							<h4 class="modal-title" id="exampleModalLabel">Buscar Profesor</h4>
							<button class="close btn btn-danger" type="button" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">x</span>
							</button>
						</div>
						<div class="modal-body oscuro">
							<p class="error-text">Introduce el nombre para buscar</p>


							<!--formulario nombre-->
							<form action="#" th:action="@{/profesores/searchName}" th:object="${profeaBuscar}"
								method="post">
								<div class"form-row">
									<div class="form-group mt-1">
										<label for="texto">Nombre</label>
										<input type="text" placeholder="Nombre" th:field="*{nombre}"
											class="form-control campo-form" id="exampleInputName" />
									</div>
								</div>
						</div>
						<div class="modal-footer oscuro-header">
							<button class="btn btn-secondary btn-sm" data-dismiss="modal"
								aria-hidden="true">Cancelar</button>
							<input id="sent" type="submit" th:value="Buscar" class="btn btn-primary float-right" />
						</div>
						</form>
					</div>
				</div>
			</div>

		</div>
		<!-- fin modal buscar por nombre-->







		<!--create modal-->
		<div class="modal fade" id="crearProfe">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header oscuro-header">
						<h4 class="modal-title" id="exampleModalLabel">Crear profesor/a</h4>
						<button class="close btn btn-danger" type="button" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">x</span>
						</button>
					</div>
					<div class="modal-body oscuro">
						<p class="error-text">Introduce el nombre para el nuevo profesor
							<!--formulario nombre a editar-->
						<form action="#" th:action="@{/profesores/add/}" th:object="${profeNuevo}" method="post"
							class="needs-validation" novalidate>
							<div class"form-row">
								<div class="form-group mt-1">
									<div class="form-group mt-1">
										<label for="texto">DNI</label>
										<input type="text" th:field="*{dni}" class="form-control campo-form" id="exampleInputDni"
											required pattern="[0-9]{8}[a-zA-Z]" placeholder="DNI" />
										<div class="alert alert-danger invalid-feedback">
											Un DNI está formado por 8 números seguidos de una letra
										</div>
									</div>
									<label for="nombre">Nombre</label>
									<input type="text" th:field="*{nombre}" class="form-control campo-form" id="nombre"
										placeholder="Nombre" />
									<label for="apellidos">Apellidos</label>
									<input type="text" th:field="*{apellidos}" class="form-control campo-form" id="apellidos"
										placeholder="Apellidos" />

								</div>
							</div>
					</div>
					<div class="modal-footer oscuro-header">
						<button class="btn btn-secondary btn-sm" data-dismiss="modal"
							aria-hidden="true">Cancelar</button>
						<input type="submit" value="Crear" class="btn btn-primary float-right" />
					</div>
					</form>
				</div>
			</div>
		</div>
		<!-- fin create modal-->

		<!--delete modal-->
		<div th:each="profe:${listaProfesores}">
			<div class="modal fade" th:id="modal-delete+${profe.id}">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header oscuro-header">
							<h4 class="modal-title" id="exampleModalLabel">Borrar</h4>
							<button class="close btn btn-danger" type="button" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">x</span>
							</button>
						</div>
						<div class="modal-body oscuro">
							<p class="error-text">Seguro que quieres borrar a este profesor?
								<strong><span th:text="${profe.nombre}"> </span></strong>
							</p>
						</div>
						<div class="modal-footer oscuro-header">
							<button class="btn btn-secondary btn-sm" data-dismiss="modal"
								aria-hidden="true">Cancelar</button>
							<a th:href="@{/profesores/delete/{id}(id=${profe.id})}">
								<span class="btn btn-danger btn-sm" value="delete">Borrar</span>
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- fin delete modal-->

		<!-- edit modal-->
		<div th:each="profe:${listaProfesores}">
			<div class="modal fade" th:id="modal-edit+${profe.id}">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header oscuro-header">
							<h4 class="modal-title" id="exampleModalLabel">Modificar</h4>
							<button class="close btn btn-danger" type="button" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">x</span>
							</button>
						</div>
						<div class="modal-body oscuro">
							<p class="error-text">Introduce el nombre nuevo para el profesor:
								<strong><span th:text="${profe.nombre}"> </span></strong>
							</p>
							<!--formulario nombre a editar-->
							<form action="#" th:action="@{/profesores/edit/{id}(id=${profe.id})}"
								th:object="${profeaEditar}" method="post">
								<div class"form-row">
									<div class="form-group mt-1">
										<label for="texto">Nombre</label>
										<input type="text" th:field="*{nombre}" class="form-control campo-form"
											id="exampleInputNom" th:attr="placeholder=${profe.nombre}" />
									</div>
									<div class="form-group mt-1">
										<label for="texto">Apellidos</label>
										<input type="text" th:field="*{apellidos}" class="form-control campo-form"
											id="exampleInputSurname" th:attr="placeholder=${profe.apellidos}" />
									</div>
								</div>
						</div>
						<div class="modal-footer oscuro-header">
							<button class="btn btn-secondary btn-sm" data-dismiss="modal"
								aria-hidden="true">Cancelar</button>
							<input type="submit" value="Modificar" class="btn btn-primary float-right" />
						</div>
						</form>
					</div>
				</div>
			</div>

		</div>
		<!-- fin delete modal-->


		<div class="toast-container position-fixed bottom-0 end-0 p-3">
			<div th:if="${vacio}" id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
				data-delay="5000">
				<div class="toast-header oscuro-header blue-letter">
					<i class="fas fa-exclamation-triangle me-2 fa-beat" style="color: #e00606;"></i>
					<strong class="me-auto">¡Alerta!</strong>
					<small>Justo ahora</small>
					<button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
				</div>
				<div class="toast-body oscuro-panel">
					¡No deberías dejar a la escuela sin profesores!
				</div>
			</div>
		</div>


	</div>
	<script th:inline="javascript">
		var vacio = /*[[${vacio}]]*/ false;

		if (vacio) {
			const toastLiveExample = document.getElementById('liveToast');
			const toastBootstrap = new bootstrap.Toast(toastLiveExample);
			const toastCloseButton = toastLiveExample.querySelector('.btn-close');

			toastCloseButton.addEventListener('click', function () {
				toastBootstrap.hide();
			});

			toastBootstrap.show();
		}
		
		document.addEventListener('DOMContentLoaded', function() {
            document.title = 'Profesores';
            })
	</script>
</body>


<script th:src="@{/static/js/validaForm.js}"></script>

</html>